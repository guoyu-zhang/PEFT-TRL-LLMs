Loading python/3.11.4
  Loading requirement: phys/compilers/gcc/11.2.0 osgeo/1.0
/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/trl/trainer/ppo_config.py:141: UserWarning: The `optimize_cuda_cache` arguement will be deprecated soon, please use `optimize_device_cache` instead.
  warnings.warn(
Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/transformers/models/auto/auto_factory.py:472: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:12<00:12, 12.04s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:15<00:00,  6.93s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:15<00:00,  7.70s/it]
/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/transformers/utils/hub.py:374: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/datasets/load.py:2088: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
  0%|          | 0/400 [00:00<?, ?it/s]  0%|          | 1/400 [00:04<30:21,  4.57s/it] 18%|â–ˆâ–Š        | 71/400 [00:04<00:15, 21.44it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 153/400 [00:04<00:04, 54.60it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 238/400 [00:04<00:01, 99.08it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 310/400 [00:04<00:00, 144.98it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 381/400 [00:05<00:00, 198.87it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 400/400 [00:05<00:00, 78.56it/s] 
/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/trl/trainer/utils.py:548: UserWarning: The passed formatting_func has more than one argument. Usually that function should have a single argument `example` which corresponds to the dictionary returned by each element of the dataset. Make sure you know what you are doing.
  warnings.warn(
/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:194: UserWarning: You didn't pass a `max_seq_length` argument to the SFTTrainer, this will default to 1024
  warnings.warn(
Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:267: UserWarning: You passed `packing=True` to the SFTTrainer, and you are training your model with `max_steps` strategy. The dataset will be iterated until the `max_steps` are reached.
  warnings.warn(
wandb: Currently logged in as: gyzhang2016. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /exports/eddie3_homes_local/s1808795/git/PEFT-TRL-LLMs/job_scripts/wandb/run-20231117_132013-6ktyafba
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sft_llama2
wandb: â­ï¸ View project at https://wandb.ai/gyzhang2016/huggingface
wandb: ğŸš€ View run at https://wandb.ai/gyzhang2016/huggingface/runs/6ktyafba
  0%|          | 0/500 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
  0%|          | 1/500 [00:17<2:24:45, 17.41s/it]  0%|          | 2/500 [00:20<1:12:15,  8.71s/it]  1%|          | 3/500 [00:22<49:04,  5.92s/it]    1%|          | 4/500 [00:25<38:11,  4.62s/it]  1%|          | 5/500 [00:27<32:10,  3.90s/it]  1%|          | 6/500 [00:30<28:32,  3.47s/it]  1%|â–         | 7/500 [00:33<26:14,  3.19s/it]  2%|â–         | 8/500 [00:35<24:42,  3.01s/it]  2%|â–         | 9/500 [00:38<23:41,  2.90s/it]  2%|â–         | 10/500 [00:41<22:59,  2.82s/it]                                                  2%|â–         | 10/500 [00:41<22:59,  2.82s/it]  2%|â–         | 11/500 [00:44<23:20,  2.86s/it]  2%|â–         | 12/500 [00:46<22:44,  2.80s/it]  3%|â–         | 13/500 [00:49<22:20,  2.75s/it]  3%|â–         | 14/500 [00:51<22:02,  2.72s/it]  3%|â–         | 15/500 [00:54<21:50,  2.70s/it]  3%|â–         | 16/500 [00:57<21:41,  2.69s/it]  3%|â–         | 17/500 [00:59<21:34,  2.68s/it]  4%|â–         | 18/500 [01:02<21:29,  2.67s/it]  4%|â–         | 19/500 [01:05<21:24,  2.67s/it]  4%|â–         | 20/500 [01:07<21:23,  2.67s/it]                                                  4%|â–         | 20/500 [01:07<21:23,  2.67s/it]  4%|â–         | 21/500 [01:10<21:59,  2.76s/it]  4%|â–         | 22/500 [01:13<21:44,  2.73s/it]  5%|â–         | 23/500 [01:16<21:32,  2.71s/it]  5%|â–         | 24/500 [01:18<21:23,  2.70s/it]  5%|â–Œ         | 25/500 [01:21<21:17,  2.69s/it]  5%|â–Œ         | 26/500 [01:24<21:11,  2.68s/it]  5%|â–Œ         | 27/500 [01:26<21:06,  2.68s/it]  6%|â–Œ         | 28/500 [01:29<21:02,  2.68s/it]  6%|â–Œ         | 29/500 [01:32<20:59,  2.67s/it]  6%|â–Œ         | 30/500 [01:34<20:56,  2.67s/it]                                                  6%|â–Œ         | 30/500 [01:34<20:56,  2.67s/it]  6%|â–Œ         | 31/500 [01:37<21:35,  2.76s/it]  6%|â–‹         | 32/500 [01:40<21:19,  2.73s/it]  7%|â–‹         | 33/500 [01:43<21:07,  2.71s/it]  7%|â–‹         | 34/500 [01:45<20:58,  2.70s/it]  7%|â–‹         | 35/500 [01:48<20:51,  2.69s/it]  7%|â–‹         | 36/500 [01:51<20:45,  2.68s/it]  7%|â–‹         | 37/500 [01:53<20:41,  2.68s/it]  8%|â–Š         | 38/500 [01:56<20:38,  2.68s/it]  8%|â–Š         | 39/500 [01:59<20:33,  2.68s/it]  8%|â–Š         | 40/500 [02:01<20:29,  2.67s/it]                                                  8%|â–Š         | 40/500 [02:01<20:29,  2.67s/it]  8%|â–Š         | 41/500 [02:04<21:08,  2.76s/it]  8%|â–Š         | 42/500 [02:07<20:53,  2.74s/it]  9%|â–Š         | 43/500 [02:10<20:41,  2.72s/it]  9%|â–‰         | 44/500 [02:12<20:31,  2.70s/it]  9%|â–‰         | 45/500 [02:15<20:24,  2.69s/it]  9%|â–‰         | 46/500 [02:18<20:17,  2.68s/it]  9%|â–‰         | 47/500 [02:20<20:12,  2.68s/it] 10%|â–‰         | 48/500 [02:23<20:07,  2.67s/it] 10%|â–‰         | 49/500 [02:26<20:03,  2.67s/it] 10%|â–ˆ         | 50/500 [02:28<20:00,  2.67s/it]                                                 10%|â–ˆ         | 50/500 [02:28<20:00,  2.67s/it] 10%|â–ˆ         | 51/500 [02:31<20:32,  2.75s/it] 10%|â–ˆ         | 52/500 [02:34<20:18,  2.72s/it] 11%|â–ˆ         | 53/500 [02:37<20:07,  2.70s/it] 11%|â–ˆ         | 54/500 [02:39<20:00,  2.69s/it] 11%|â–ˆ         | 55/500 [02:42<19:53,  2.68s/it] 11%|â–ˆ         | 56/500 [02:45<19:47,  2.67s/it] 11%|â–ˆâ–        | 57/500 [02:47<19:42,  2.67s/it] 12%|â–ˆâ–        | 58/500 [02:50<19:38,  2.67s/it] 12%|â–ˆâ–        | 59/500 [02:53<19:34,  2.66s/it] 12%|â–ˆâ–        | 60/500 [02:55<19:31,  2.66s/it]                                                 12%|â–ˆâ–        | 60/500 [02:55<19:31,  2.66s/it] 12%|â–ˆâ–        | 61/500 [02:58<20:06,  2.75s/it] 12%|â–ˆâ–        | 62/500 [03:01<19:52,  2.72s/it] 13%|â–ˆâ–        | 63/500 [03:03<19:41,  2.70s/it] 13%|â–ˆâ–        | 64/500 [03:06<19:34,  2.69s/it] 13%|â–ˆâ–        | 65/500 [03:09<19:27,  2.68s/it] 13%|â–ˆâ–        | 66/500 [03:11<19:21,  2.68s/it] 13%|â–ˆâ–        | 67/500 [03:14<19:16,  2.67s/it] 14%|â–ˆâ–        | 68/500 [03:17<19:13,  2.67s/it] 14%|â–ˆâ–        | 69/500 [03:19<19:09,  2.67s/it] 14%|â–ˆâ–        | 70/500 [03:22<19:05,  2.66s/it]                                                 14%|â–ˆâ–        | 70/500 [03:22<19:05,  2.66s/it] 14%|â–ˆâ–        | 71/500 [03:25<19:30,  2.73s/it] 14%|â–ˆâ–        | 72/500 [03:28<19:18,  2.71s/it] 15%|â–ˆâ–        | 73/500 [03:30<19:09,  2.69s/it] 15%|â–ˆâ–        | 74/500 [03:33<19:02,  2.68s/it] 15%|â–ˆâ–Œ        | 75/500 [03:36<18:56,  2.67s/it] 15%|â–ˆâ–Œ        | 76/500 [03:38<18:54,  2.68s/it] 15%|â–ˆâ–Œ        | 77/500 [03:41<18:50,  2.67s/it] 16%|â–ˆâ–Œ        | 78/500 [03:44<18:46,  2.67s/it] 16%|â–ˆâ–Œ        | 79/500 [03:46<18:42,  2.67s/it] 16%|â–ˆâ–Œ        | 80/500 [03:49<18:38,  2.66s/it]                                                 16%|â–ˆâ–Œ        | 80/500 [03:49<18:38,  2.66s/it] 16%|â–ˆâ–Œ        | 81/500 [03:52<19:04,  2.73s/it] 16%|â–ˆâ–‹        | 82/500 [03:54<18:52,  2.71s/it] 17%|â–ˆâ–‹        | 83/500 [03:57<18:43,  2.69s/it] 17%|â–ˆâ–‹        | 84/500 [04:00<18:36,  2.68s/it] 17%|â–ˆâ–‹        | 85/500 [04:02<18:30,  2.67s/it] 17%|â–ˆâ–‹        | 86/500 [04:05<18:25,  2.67s/it] 17%|â–ˆâ–‹        | 87/500 [04:08<18:20,  2.67s/it] 18%|â–ˆâ–Š        | 88/500 [04:10<18:17,  2.66s/it] 18%|â–ˆâ–Š        | 89/500 [04:13<18:13,  2.66s/it] 18%|â–ˆâ–Š        | 90/500 [04:16<18:10,  2.66s/it]                                                 18%|â–ˆâ–Š        | 90/500 [04:16<18:10,  2.66s/it] 18%|â–ˆâ–Š        | 91/500 [04:19<18:39,  2.74s/it] 18%|â–ˆâ–Š        | 92/500 [04:21<18:26,  2.71s/it] 19%|â–ˆâ–Š        | 93/500 [04:24<18:17,  2.70s/it] 19%|â–ˆâ–‰        | 94/500 [04:27<18:09,  2.68s/it] 19%|â–ˆâ–‰        | 95/500 [04:29<18:03,  2.68s/it] 19%|â–ˆâ–‰        | 96/500 [04:32<17:58,  2.67s/it] 19%|â–ˆâ–‰        | 97/500 [04:35<17:54,  2.67s/it] 20%|â–ˆâ–‰        | 98/500 [04:37<17:50,  2.66s/it] 20%|â–ˆâ–‰        | 99/500 [04:40<17:47,  2.66s/it] 20%|â–ˆâ–ˆ        | 100/500 [04:43<17:44,  2.66s/it]                                                  20%|â–ˆâ–ˆ        | 100/500 [04:43<17:44,  2.66s/it] 20%|â–ˆâ–ˆ        | 101/500 [04:45<18:10,  2.73s/it] 20%|â–ˆâ–ˆ        | 102/500 [04:48<17:58,  2.71s/it] 21%|â–ˆâ–ˆ        | 103/500 [04:51<17:49,  2.69s/it] 21%|â–ˆâ–ˆ        | 104/500 [04:53<17:42,  2.68s/it] 21%|â–ˆâ–ˆ        | 105/500 [04:56<17:37,  2.68s/it] 21%|â–ˆâ–ˆ        | 106/500 [04:59<17:33,  2.67s/it] 21%|â–ˆâ–ˆâ–       | 107/500 [05:01<17:29,  2.67s/it] 22%|â–ˆâ–ˆâ–       | 108/500 [05:04<17:25,  2.67s/it] 22%|â–ˆâ–ˆâ–       | 109/500 [05:07<17:21,  2.66s/it] 22%|â–ˆâ–ˆâ–       | 110/500 [05:09<17:18,  2.66s/it]                                                  22%|â–ˆâ–ˆâ–       | 110/500 [05:09<17:18,  2.66s/it] 22%|â–ˆâ–ˆâ–       | 111/500 [05:12<17:43,  2.74s/it] 22%|â–ˆâ–ˆâ–       | 112/500 [05:15<17:32,  2.71s/it] 23%|â–ˆâ–ˆâ–       | 113/500 [05:18<17:23,  2.70s/it] 23%|â–ˆâ–ˆâ–       | 114/500 [05:20<17:16,  2.69s/it] 23%|â–ˆâ–ˆâ–       | 115/500 [05:23<17:11,  2.68s/it] 23%|â–ˆâ–ˆâ–       | 116/500 [05:26<17:06,  2.67s/it] 23%|â–ˆâ–ˆâ–       | 117/500 [05:28<17:02,  2.67s/it] 24%|â–ˆâ–ˆâ–       | 118/500 [05:31<16:58,  2.67s/it] 24%|â–ˆâ–ˆâ–       | 119/500 [05:34<16:55,  2.67s/it] 24%|â–ˆâ–ˆâ–       | 120/500 [05:36<16:53,  2.67s/it]                                                  24%|â–ˆâ–ˆâ–       | 120/500 [05:36<16:53,  2.67s/it] 24%|â–ˆâ–ˆâ–       | 121/500 [05:39<17:18,  2.74s/it] 24%|â–ˆâ–ˆâ–       | 122/500 [05:42<17:06,  2.72s/it] 25%|â–ˆâ–ˆâ–       | 123/500 [05:45<16:57,  2.70s/it] 25%|â–ˆâ–ˆâ–       | 124/500 [05:47<16:50,  2.69s/it] 25%|â–ˆâ–ˆâ–Œ       | 125/500 [05:50<16:44,  2.68s/it] 25%|â–ˆâ–ˆâ–Œ       | 126/500 [05:52<16:39,  2.67s/it] 25%|â–ˆâ–ˆâ–Œ       | 127/500 [05:55<16:35,  2.67s/it] 26%|â–ˆâ–ˆâ–Œ       | 128/500 [06:00<21:22,  3.45s/it] 26%|â–ˆâ–ˆâ–Œ       | 129/500 [06:03<19:52,  3.21s/it] 26%|â–ˆâ–ˆâ–Œ       | 130/500 [06:06<18:47,  3.05s/it]                                                  26%|â–ˆâ–ˆâ–Œ       | 130/500 [06:06<18:47,  3.05s/it] 26%|â–ˆâ–ˆâ–Œ       | 131/500 [06:09<18:27,  3.00s/it] 26%|â–ˆâ–ˆâ–‹       | 132/500 [06:11<17:46,  2.90s/it] 27%|â–ˆâ–ˆâ–‹       | 133/500 [06:14<17:16,  2.83s/it] 27%|â–ˆâ–ˆâ–‹       | 134/500 [06:17<16:55,  2.77s/it] 27%|â–ˆâ–ˆâ–‹       | 135/500 [06:19<16:39,  2.74s/it] 27%|â–ˆâ–ˆâ–‹       | 136/500 [06:22<16:27,  2.71s/it] 27%|â–ˆâ–ˆâ–‹       | 137/500 [06:25<16:18,  2.70s/it] 28%|â–ˆâ–ˆâ–Š       | 138/500 [06:27<16:14,  2.69s/it] 28%|â–ˆâ–ˆâ–Š       | 139/500 [06:30<16:07,  2.68s/it] 28%|â–ˆâ–ˆâ–Š       | 140/500 [06:33<16:02,  2.67s/it]                                                  28%|â–ˆâ–ˆâ–Š       | 140/500 [06:33<16:02,  2.67s/it] 28%|â–ˆâ–ˆâ–Š       | 141/500 [06:35<16:20,  2.73s/it] 28%|â–ˆâ–ˆâ–Š       | 142/500 [06:38<16:09,  2.71s/it] 29%|â–ˆâ–ˆâ–Š       | 143/500 [06:41<16:01,  2.69s/it] 29%|â–ˆâ–ˆâ–‰       | 144/500 [06:43<15:54,  2.68s/it] 29%|â–ˆâ–ˆâ–‰       | 145/500 [06:46<15:50,  2.68s/it] 29%|â–ˆâ–ˆâ–‰       | 146/500 [06:49<15:47,  2.68s/it] 29%|â–ˆâ–ˆâ–‰       | 147/500 [06:51<15:42,  2.67s/it] 30%|â–ˆâ–ˆâ–‰       | 148/500 [06:54<15:38,  2.67s/it] 30%|â–ˆâ–ˆâ–‰       | 149/500 [06:57<15:34,  2.66s/it] 30%|â–ˆâ–ˆâ–ˆ       | 150/500 [06:59<15:31,  2.66s/it]                                                  30%|â–ˆâ–ˆâ–ˆ       | 150/500 [06:59<15:31,  2.66s/it] 30%|â–ˆâ–ˆâ–ˆ       | 151/500 [07:02<15:51,  2.73s/it] 30%|â–ˆâ–ˆâ–ˆ       | 152/500 [07:05<15:41,  2.71s/it] 31%|â–ˆâ–ˆâ–ˆ       | 153/500 [07:08<15:33,  2.69s/it] 31%|â–ˆâ–ˆâ–ˆ       | 154/500 [07:10<15:28,  2.68s/it] 31%|â–ˆâ–ˆâ–ˆ       | 155/500 [07:13<15:23,  2.68s/it] 31%|â–ˆâ–ˆâ–ˆ       | 156/500 [07:16<15:18,  2.67s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 157/500 [07:18<15:14,  2.67s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 158/500 [07:21<15:11,  2.66s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 159/500 [07:24<15:07,  2.66s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 160/500 [07:26<15:04,  2.66s/it]                                                  32%|â–ˆâ–ˆâ–ˆâ–      | 160/500 [07:26<15:04,  2.66s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 161/500 [07:29<15:27,  2.74s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 162/500 [07:32<15:16,  2.71s/it] 33%|â–ˆâ–ˆâ–ˆâ–      | 163/500 [07:34<15:08,  2.70s/it] 33%|â–ˆâ–ˆâ–ˆâ–      | 164/500 [07:37<15:02,  2.68s/it] 33%|â–ˆâ–ˆâ–ˆâ–      | 165/500 [07:40<14:56,  2.68s/it] 33%|â–ˆâ–ˆâ–ˆâ–      | 166/500 [07:42<14:52,  2.67s/it] 33%|â–ˆâ–ˆâ–ˆâ–      | 167/500 [07:45<14:48,  2.67s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 168/500 [07:48<14:45,  2.67s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 169/500 [07:50<14:41,  2.66s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 170/500 [07:53<14:38,  2.66s/it]                                                  34%|â–ˆâ–ˆâ–ˆâ–      | 170/500 [07:53<14:38,  2.66s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 171/500 [07:56<14:56,  2.73s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 172/500 [07:59<14:47,  2.71s/it] 35%|â–ˆâ–ˆâ–ˆâ–      | 173/500 [08:01<14:41,  2.70s/it] 35%|â–ˆâ–ˆâ–ˆâ–      | 174/500 [08:04<14:36,  2.69s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 175/500 [08:07<14:31,  2.68s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 176/500 [08:09<14:26,  2.67s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 177/500 [08:12<14:22,  2.67s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 178/500 [08:15<14:18,  2.67s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 179/500 [08:17<14:15,  2.67s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 180/500 [08:20<14:14,  2.67s/it]                                                  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 180/500 [08:20<14:14,  2.67s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 181/500 [08:23<14:37,  2.75s/it] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 182/500 [08:25<14:25,  2.72s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 183/500 [08:28<14:17,  2.70s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 184/500 [08:31<14:10,  2.69s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 185/500 [08:33<14:04,  2.68s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 186/500 [08:36<13:59,  2.68s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 187/500 [08:39<13:55,  2.67s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 188/500 [08:41<13:52,  2.67s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 189/500 [08:44<13:48,  2.67s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 190/500 [08:47<13:45,  2.66s/it]                                                  38%|â–ˆâ–ˆâ–ˆâ–Š      | 190/500 [08:47<13:45,  2.66s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 191/500 [08:50<14:06,  2.74s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 192/500 [08:52<13:56,  2.72s/it] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 193/500 [08:55<13:48,  2.70s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 194/500 [08:58<13:44,  2.69s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 195/500 [09:00<13:38,  2.68s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 196/500 [09:03<13:33,  2.68s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 197/500 [09:06<13:29,  2.67s/it] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 198/500 [09:08<13:25,  2.67s/it] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 199/500 [09:11<13:22,  2.67s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 200/500 [09:14<13:19,  2.67s/it]                                                  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 200/500 [09:14<13:19,  2.67s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 201/500 [09:17<13:35,  2.73s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 202/500 [09:19<13:26,  2.71s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 203/500 [09:22<13:19,  2.69s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 204/500 [09:24<13:14,  2.68s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 205/500 [09:27<13:09,  2.68s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 206/500 [09:30<13:05,  2.67s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 207/500 [09:32<13:01,  2.67s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 208/500 [09:35<12:58,  2.67s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 209/500 [09:38<12:55,  2.67s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 210/500 [09:40<12:52,  2.66s/it]                                                  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 210/500 [09:40<12:52,  2.66s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 211/500 [09:43<13:09,  2.73s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 212/500 [09:46<13:00,  2.71s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 213/500 [09:49<12:53,  2.70s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 214/500 [09:51<12:47,  2.69s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 215/500 [09:54<12:44,  2.68s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 216/500 [09:57<12:39,  2.67s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 217/500 [09:59<12:35,  2.67s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 218/500 [10:02<12:32,  2.67s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 219/500 [10:05<12:28,  2.66s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 220/500 [10:07<12:25,  2.66s/it]                                                  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 220/500 [10:07<12:25,  2.66s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 221/500 [10:10<12:41,  2.73s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 222/500 [10:13<12:33,  2.71s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 223/500 [10:16<12:26,  2.69s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 224/500 [10:18<12:20,  2.68s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 225/500 [10:21<12:17,  2.68s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 226/500 [10:24<12:14,  2.68s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 227/500 [10:26<12:09,  2.67s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 228/500 [10:29<12:05,  2.67s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 229/500 [10:32<12:02,  2.67s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 230/500 [10:34<11:59,  2.66s/it]                                                  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 230/500 [10:34<11:59,  2.66s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 231/500 [10:37<12:15,  2.73s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 232/500 [10:40<12:06,  2.71s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 233/500 [10:42<11:59,  2.69s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 234/500 [10:45<11:53,  2.68s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 235/500 [10:48<11:49,  2.68s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 236/500 [10:50<11:45,  2.67s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 237/500 [10:53<11:41,  2.67s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 238/500 [10:56<11:38,  2.67s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 239/500 [10:58<11:35,  2.66s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 240/500 [11:01<11:32,  2.66s/it]                                                  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 240/500 [11:01<11:32,  2.66s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 241/500 [11:04<11:45,  2.72s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 242/500 [11:07<11:37,  2.70s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 243/500 [11:09<11:31,  2.69s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 244/500 [11:12<11:26,  2.68s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 245/500 [11:14<11:21,  2.67s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 246/500 [11:17<11:18,  2.67s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 247/500 [11:20<11:14,  2.67s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 248/500 [11:22<11:11,  2.66s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 249/500 [11:25<11:08,  2.66s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 250/500 [11:28<11:06,  2.66s/it]                                                  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 250/500 [11:28<11:06,  2.66s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 251/500 [11:31<11:21,  2.74s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 252/500 [11:33<11:13,  2.71s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 253/500 [11:36<11:06,  2.70s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 254/500 [11:39<11:00,  2.69s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 255/500 [11:41<10:55,  2.68s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 256/500 [11:47<13:59,  3.44s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 257/500 [11:49<12:58,  3.20s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 258/500 [11:52<12:15,  3.04s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 259/500 [11:55<11:44,  2.92s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 260/500 [11:57<11:22,  2.84s/it]                                                  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 260/500 [11:57<11:22,  2.84s/it]Traceback (most recent call last):
  File "/home/s1808795/git/PEFT-TRL-LLMs/python_files/sft_example.py", line 201, in <module>
    trainer.train()
  File "/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py", line 280, in train
    output = super().train(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/transformers/trainer.py", line 1555, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/transformers/trainer.py", line 1922, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, model, trial, epoch, ignore_keys_for_eval)
  File "/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/transformers/trainer.py", line 2282, in _maybe_log_save_evaluate
    self._save_checkpoint(model, trial, metrics=metrics)
  File "/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/transformers/trainer.py", line 2350, in _save_checkpoint
    self.save_model(output_dir, _internal_call=True)
  File "/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/transformers/trainer.py", line 2843, in save_model
    self._save(output_dir)
  File "/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/transformers/trainer.py", line 2901, in _save
    self.model.save_pretrained(
  File "/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/peft/peft_model.py", line 228, in save_pretrained
    safe_save_file(
  File "/exports/eddie/scratch/s1808795/PEFT-TRL-LLMs/venv/lib/python3.11/site-packages/safetensors/torch.py", line 281, in save_file
    serialize_file(_flatten(tensors), filename, metadata=metadata)
safetensors_rust.SafetensorError: Error while serializing: IoError(Os { code: 122, kind: FilesystemQuotaExceeded, message: "Disk quota exceeded" })
wandb: WARNING No program path found, not creating job artifact. See https://docs.wandb.ai/guides/launch/create-job
wandb: - 0.008 MB of 0.008 MB uploadedwandb: \ 0.008 MB of 0.022 MB uploadedwandb: | 0.022 MB of 0.022 MB uploadedwandb: 
wandb: Run history:
wandb:         train/epoch â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–…â–…â–…â–…â–†â–†â–†â–‡â–‡â–‡â–‡â–ˆâ–ˆ
wandb:   train/global_step â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–…â–…â–…â–…â–†â–†â–†â–‡â–‡â–‡â–‡â–ˆâ–ˆ
wandb: train/learning_rate â–â–‚â–ƒâ–ƒâ–„â–…â–†â–†â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…
wandb:          train/loss â–‡â–ˆâ–ˆâ–‡â–†â–…â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–ƒâ–‚â–â–‚â–â–‚â–‚â–‚â–‚â–‚â–â–‚â–â–
wandb: 
wandb: Run summary:
wandb:         train/epoch 0.52
wandb:   train/global_step 260
wandb: train/learning_rate 7e-05
wandb:          train/loss 1.4358
wandb: 
wandb: ğŸš€ View run sft_llama2 at: https://wandb.ai/gyzhang2016/huggingface/runs/6ktyafba
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231117_132013-6ktyafba/logs
